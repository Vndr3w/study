# Домашнее задание к занятию «Резервное копирование баз данных» - Лукинов Андрей

## Задание 1. Резервное копирование

## Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

<details>
<summary>Ответ</summary>

*Приведите ответ в свободной форме.*

1.1 Для полного восстановления данных в объёме за предыдущий день подходит стратегия ежедневных полных бэкапов (full backups). Эти бэкапы захватывают всю базу данных ежедневно, обеспечивая полную копию для восстановления без потерь за день.

1.2 Для восстановления данных на конкретный момент, например за час до поломки, используется Point-in-Time Recovery (PITR). Это сочетает полный бэкап с последовательными логами транзакций (transaction logs или WAL в PostgreSQL), позволяя откатить базу к нужной точке времени.

1.3* Да, такой кейс возможен с помощью высокодоступных кластеров (High Availability, HA) на базе репликации: master-slave или multi-master. При поломке primary происходит автоматический failover на standby-реплику или починенную ноду, минимизируя downtime до секунд.

</details>

### Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

<details>
<summary>Ответ</summary>

*Приведите ответ в свободной форме.*

2.1 Пример резервного копирования: `pg_dump -Fc mydb > db.dump` создаёт архив в custom-формате.​ Для восстановления: сначала удалить БД dropdb mydb, затем `pg_restore -C -d postgres db.dump` пересоздаст и восстановит БД.

2.1* Да, автоматизация возможна через cron-джобы. Например, скрипт с pg_dump запускается по расписанию (ежедневно ночью), а старые бэкапы удаляются find-командой; `crontab: 0 0 * * 0 pg_dump -U postgres dbname > ~/backups/dbname.bak`

</details>

### Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL. 

3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

<details>
<summary>Ответ</summary>

*Приведите ответ в свободной форме.*

3.1 Включите binary logging (`log-bin` в my.cnf). Полный бэкап: `mysqldump`. Инкремент: `FLUSH BINARY LOGS;`, затем `mysqlbinlog --start-datetime='2023-10-23 00:00:00' --stop-datetime='2023-10-23 23:59:59' mysql-bin.000001 > incr_backup.sql` для извлечения изменений из binlog.​

3.1* Реплика даёт real-time копию для чтения (load balancing), автоматический failover без downtime, геораспределение и бэкапы без нагрузки на master. Бэкап же требует времени на создание/восстановление и блокирует ресурсы.

</details>